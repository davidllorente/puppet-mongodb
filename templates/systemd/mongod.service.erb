[Unit]
Description=Mongod_<%= @mongod_instance %> server
Wants=network.target
After=network.target
Requires=mongod_<%= @mongod_instance %>_thp.service

[Service]
Type=forking
PIDFile=<%= scope.lookupvar('mongodb::dbdir') %>/mongod_<%= @mongod_instance %>/mongod.pid
ExecStart=/usr/bin/mongod --config /etc/mongod_<%= @mongod_instance %>.conf
Restart=on-failure
User=<%= scope.lookupvar('mongodb::run_as_user') %>
Group=<%= scope.lookupvar('mongodb::run_as_group') %>
LimitNOFILE=<%= scope.lookupvar('mongodb::ulimit_nofiles') %>
LimitNPROC=<%= scope.lookupvar('mongodb::ulimit_nproc') %>
TimeoutStartSec=<%= @mongod_systemd_timeout_start_sec %>
<%- if @mongod_systemd_memory_limit != "" -%>
MemoryLimit=<%= @mongod_systemd_memory_limit %>
<%- end -%>

[Install]
WantedBy=multi-user.target
